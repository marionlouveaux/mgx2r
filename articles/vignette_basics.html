<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vignette mgx2r - basics • mgx2r</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Vignette mgx2r - basics">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mgx2r</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_basics.html">Vignette mgx2r - basics</a>
    </li>
    <li>
      <a href="../articles/vignette_time_series.html">Vignette mgx2r - time serie</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/marionlouveaux/mgx2r">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Vignette mgx2r - basics</h1>
                        <h4 class="author">Marion Louveaux</h4>
            
            <h4 class="date">2018-10-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/marionlouveaux/mgx2r/blob/master/vignettes/vignette_basics.Rmd"><code>vignettes/vignette_basics.Rmd</code></a></small>
      <div class="hidden name"><code>vignette_basics.Rmd</code></div>

    </div>

    
    
<p>The goal of this vignette is to explain how to use the mgx2r package and give example of data visualisation with Plotly. It introduces the modified_read.ply() and modified_read.cellGraph() functions that allow to read the .ply files generated by MorphoGraphX and to use further their content, for instance, by visualising the mesh(es) or by doing statistics on the cell graph dataframes. For time serie visualisation, see the time serie vignette.<br>
N.B: this package also include a function to write an R 3D object as a .ply mesh readable by MorphoGraphX, but I will not talk about it in this vignette.</p>
<div id="librairies-needed" class="section level2">
<h2 class="hasAnchor">
<a href="#librairies-needed" class="anchor"></a>Librairies needed</h2>
<p>This vignette requires the mgx2r package, as well as some other additionnal packages. Plotly is a package for displaying 3D interactive graphs, the other packages are needed for colors (colorRamps and RColorBrewer), and for coding (magrittr, dplyr and glue).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(colorRamps)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(mgx2r)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(plotly)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(RColorBrewer)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># devtools::install_github("marionlouveaux/cellviz3d")</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(cellviz3d)</a></code></pre></div>
</div>
<div id="loading-data" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-data" class="anchor"></a>Loading data</h2>
<p>Some .ply demonstration data coming from my PhD thesis are attached to this package and used here in the vignette. This dataset is a timelapse recording of the development of a shoot apical meristem of the plant  expressing a membrane marker. I took one 3D stack every 12h and have 5 timepoints in total. For more information regarding the generation of this dataset, see <code>help.search("mgx2r-package")</code>.</p>
<p>Here, in this first vignette, we I will select the first timepoint only. I have one .ply for the mesh and one .ply for the cellGraph.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">### Full datataset</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">filePly &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"full/mesh/mesh_meristem_full_T0.ply"</span>, <span class="dt">package =</span> <span class="st">"mgx2r"</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">fileCellGraph &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>,  <span class="st">"full/cellGraph/cellGraph_meristem_full_T0.ply"</span>, <span class="dt">package =</span> <span class="st">"mgx2r"</span>)</a></code></pre></div>
<p>As generating following plots with the full dataset might be slow, you can try with the cropped dataset.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">### Cropped dataset</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">filePly &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"cropped/mesh/mesh_meristem_cropped_T0.ply"</span>, <span class="dt">package =</span> <span class="st">"mgx2r"</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">fileCellGraph &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>,  <span class="st">"cropped/cellGraph/cellGraph_meristem_cropped_T0.ply"</span>, <span class="dt">package =</span> <span class="st">"mgx2r"</span>)</a></code></pre></div>
</div>
<div id="mesh-and-cell-graph-e-g-cells-and-edges-properties" class="section level2">
<h2 class="hasAnchor">
<a href="#mesh-and-cell-graph-e-g-cells-and-edges-properties" class="anchor"></a>Mesh and cell graph (e.g. cells and edges properties)</h2>
<p>I load the .ply mesh with the modified_read.ply() function. This function is a modified version of read.ply function from geomorph R package to specifically read MGX ply files. I takes in account the fact that each triangular face of the mesh can get several colors (one for the label, one for the fluorescent signal projected on the mesh -membrane or microtubules-…).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">mgx_palette &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"#800000"</span>, <span class="st">"#FF0000"</span>, <span class="st">"#808000"</span>, <span class="st">"#FFFF00"</span>,</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">                <span class="st">"#008000"</span>, <span class="st">"#00FF00"</span>, <span class="st">"#008080"</span>, <span class="st">"#00FFFF"</span>,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                <span class="st">"#000080"</span>, <span class="st">"#0000FF"</span>, <span class="st">"#800080"</span>, <span class="st">"#FF00FF"</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">myMesh &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_mgxPly.html">read_mgxPly</a></span>(</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="dt">file =</span> filePly, <span class="dt">ShowSpecimen =</span> <span class="ot">FALSE</span>, <span class="dt">addNormals =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  <span class="dt">MatCol =</span> <span class="dv">1</span>, <span class="dt">header_max =</span> <span class="dv">30</span>, <span class="dt">my_colors =</span> mgx_palette)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; [1] "Object has 7763 faces and 4158 vertices."</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="kw">str</span>(myMesh, <span class="dt">max.level =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; List of 7</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt;  $ vb           : num [1:4, 1:4158] -55 31.5 -3.2 1 -51.3 ...</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt;  $ it           : num [1:3, 1:7763] 1 3040 3041 1 3041 ...</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;  $ primitivetype: chr "triangle"</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;  $ material     :List of 2</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;  $ allColors    :List of 4</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt;  $ it_label     :Classes 'tbl_df', 'tbl' and 'data.frame':   7763 obs. of  1 variable:</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt;  $ normals      : num [1:4, 1:4158] -0.322 0.196 0.906 1 -0.36 ...</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt;  - attr(*, "class")= chr [1:2] "mesh3d" "shape3d"</span></a></code></pre></div>
<p>Over the rest of the vignette I will only show examples of visualisation with Plotly, but there is another 3D library in R called RGL.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">rgl<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/rgl/topics/mesh3d">shade3d</a></span>(myMesh)</a></code></pre></div>
<p>To change mesh color and display the new color, you can use the following command.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">myMesh<span class="op">$</span>material<span class="op">$</span>color &lt;-<span class="st"> </span>myMesh<span class="op">$</span>allColors<span class="op">$</span>Col_signal</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">rgl<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/rgl/topics/mesh3d">shade3d</a></span>(myMesh)</a></code></pre></div>
<p>Information relative to cells and cell walls (resp. vertices and edges of the cell graph) are stored in a second .ply that I read with the modified_read.cellGraph() function that I wrote myself. The modified_read.cellGraph() function reads the cell graph .ply and extract two dataframes (one for the vertices informations and one for the edges informations). These two dataframes are then combined into a list.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">myCellGraph &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_mgxCellGraph.html">read_mgxCellGraph</a></span>(<span class="dt">fileCellGraph =</span> fileCellGraph, <span class="dt">header_max =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">myCellGraph</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; $vertices</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; # A tibble: 376 x 15</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt;    label     x      y       z GeometryArea CellAxiscurv10m…</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;            &lt;int&gt;</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt;  1     3 -55.0  31.5  -3.20           33.5                9</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;  2     7 -51.3  18.6   0.0779         46.8                9</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;  3     6 -50.4  24.8  -0.0119         27.2                9</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;  4     5 -53.1  26.9  -1.39           19.7                9</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt;  5     2 -51.4  37.0  -4.00           38.4                9</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt;  6     1 -49.7  41.5  -6.23           35.4                9</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt;  7    18 -46.9 -10.5  -6.18           40.5                9</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt;  8    11 -48.0   6.85 -0.224          22.5                9</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt;  9     8 -47.8  12.5   1.07           27.9                9</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">#&gt; 10     4 -49.5  31.8  -1.64           28.1                9</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">#&gt; # ... with 366 more rows, and 9 more variables:</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">#&gt; #   CellAxiscurv10microns.1 &lt;dbl&gt;, CellAxiscurv10microns.2 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; #   CellAxiscurv10microns.3 &lt;dbl&gt;, CellAxiscurv10microns.4 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; #   CellAxiscurv10microns.5 &lt;dbl&gt;, CellAxiscurv10microns.6 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">#&gt; #   CellAxiscurv10microns.7 &lt;dbl&gt;, CellAxiscurv10microns.8 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"><span class="co">#&gt; #   CellAxiscurv10microns.9 &lt;int&gt;</span></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co">#&gt; $edges</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co">#&gt; # A tibble: 2,160 x 2</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co">#&gt;    source target</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">#&gt;     &lt;int&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">#&gt;  1      3      5</span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">#&gt;  2      3      4</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">#&gt;  3      3      2</span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">#&gt;  4      7      8</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">#&gt;  5      7      9</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">#&gt;  6      7     98</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">#&gt;  7      7      6</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">#&gt;  8      6      5</span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">#&gt;  9      6      7</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">#&gt; 10      6     98</span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">#&gt; # ... with 2,150 more rows</span></a></code></pre></div>
<p>N.B.: to see the content of one of these function, just type its name without the parentheses.</p>
<p>Last but not least, I am retrieving the location of the cell centers to display the cell ID at their location.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">meshCellcenter &lt;-<span class="st"> </span>myCellGraph<span class="op">$</span>vertices[,<span class="kw">c</span>(<span class="st">"label"</span>,<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>)]</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co"># An other way to define the cell centers without using the cell graph would be: ## issue with the code below</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co"># vertexCellcenter &lt;- purrr::map(1:ncol(myMesh$allColors$Col_label), ~ </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#   myMesh$it[ which(myMesh$allColors$Col_label[,.x] == names(which(table(myMesh$allColors$Col_label[,.x]) == 1))), .x ]</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co"># )</span></a></code></pre></div>
</div>
<div id="displaying-the-mesh-with-plotly" class="section level2">
<h2 class="hasAnchor">
<a href="#displaying-the-mesh-with-plotly" class="anchor"></a>Displaying the mesh with plotly</h2>
<div id="to-display-the-mesh-with-cell-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#to-display-the-mesh-with-cell-labels" class="anchor"></a>To display the mesh with cell labels</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw">plotlyMesh</span>(<span class="dt">meshExample =</span> myMesh,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">                 <span class="dt">meshColors =</span> myMesh<span class="op">$</span>allColors<span class="op">$</span>Col_label,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                 <span class="dt">meshCellcenter =</span> meshCellcenter) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/plotly/topics/layout">layout</a></span>(<span class="dt">scene =</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">           <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">             <span class="dt">aspectmode =</span> <span class="st">"data"</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">           ))</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"></a>
<a class="sourceLine" id="cb10-9" data-line-number="9">p1</a></code></pre></div>
<p><img src="p1labels.png" style="display: block; margin: auto;"> Colors of the cell labels are set from the HEX color codes stored in <code>myMesh$allColors$Col_label</code>. There is always three colors: one per vertex. Two are identica, and usually black with MGX (“#000000” HEX code).</p>
</div>
<div id="without-the-cell-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#without-the-cell-labels" class="anchor"></a>Without the cell labels</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">plotlyMesh</span>(<span class="dt">meshExample =</span> myMesh,</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">           <span class="dt">meshColors =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">           <span class="dt">meshCellcenter =</span> meshCellcenter)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/plotly/topics/layout">layout</a></span>(<span class="dt">scene =</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">           <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">             <span class="dt">aspectmode =</span> <span class="st">"data"</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">           ))</a></code></pre></div>
<p><img src="p1withoutlabels.png" style="display: block; margin: auto;"></p>
<p>Default color of the mesh and opacity are set in the defaultColor parameter of the plotlyMesh() function (see ?plotlyMesh for more informations).</p>
</div>
</div>
<div id="displaying-specific-info-from-cellgraph-on-the-mesh" class="section level2">
<h2 class="hasAnchor">
<a href="#displaying-specific-info-from-cellgraph-on-the-mesh" class="anchor"></a>Displaying specific info from cellGraph on the mesh</h2>
<p>The cell graph contains many information that can be added to the 3D visualisation of the mesh. I classified these information in two categories: scalars (e.g. numbers, such as growth rate, area…) and tensors (microtubule orientation, growth directions, curvature…). Below I give two examples, one with the areas and one with the principal direction of growth. If my scripts are correct, I should be able to display any scalar as for area, and any tensors, as for the principal direction of growth.</p>
<div id="scalar-info-area-growth-rate" class="section level3">
<h3 class="hasAnchor">
<a href="#scalar-info-area-growth-rate" class="anchor"></a>Scalar info (area, growth rate…)</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">p2 &lt;-<span class="st"> </span><span class="kw">plotlyMesh</span>(<span class="dt">meshExample =</span> myMesh, </a>
<a class="sourceLine" id="cb12-2" data-line-number="2">           <span class="dt">meshColors =</span> <span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(myMesh<span class="op">$</span>it_label, myCellGraph<span class="op">$</span>vertices) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">             </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(., GeometryArea),</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">           <span class="dt">meshCellcenter =</span>  meshCellcenter</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/plotly/topics/layout">layout</a></span>(<span class="dt">scene =</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">           <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">             <span class="dt">aspectmode =</span> <span class="st">"data"</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">           ))</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">p2</a></code></pre></div>
<p><img src="p2heatmap.png" style="display: block; margin: auto;"></p>
</div>
<div id="vectortensor-info-principal-dir-of-curvature" class="section level3">
<h3 class="hasAnchor">
<a href="#vectortensor-info-principal-dir-of-curvature" class="anchor"></a>Vector/tensor info (principal dir of curvature…)</h3>
<p>This part of the code is quite new and provide tools to visualise tensors, such as growth direction or curvature direction on any kind of mesh (without label, with cell label, with heatmap colors…), as long as it is already converted to a plot with plotlyMesh. The code below has not been tested extensively yet.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">meshPlotly &lt;-<span class="st"> </span><span class="kw">plotlyMesh</span>(<span class="dt">meshExample =</span> myMesh, </a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                <span class="dt">meshColors =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                <span class="dt">meshCellcenter =</span> meshCellcenter) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/plotly/topics/layout">layout</a></span>(<span class="dt">scene =</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">           <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">             <span class="dt">aspectmode =</span> <span class="st">"data"</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">           ))</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw">show_tensors</span>(<span class="dt">p =</span> meshPlotly,</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">             <span class="dt">cellGraph =</span> myCellGraph,</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">             <span class="dt">tensor_name =</span> <span class="st">"CellAxiscurv10microns"</span>,</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">             <span class="dt">scale =</span> <span class="dv">50</span>)</a></code></pre></div>
<p><img src="tensors.png" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="drawing-cell-contours" class="section level2">
<h2 class="hasAnchor">
<a href="#drawing-cell-contours" class="anchor"></a>Drawing cell contours</h2>
<p>As some may be also interested by drawing the cell contours, I have added an example here. This kind of graph is quite ressource consuming, as it is drawing each edge one by one, as a segment. Here in this example, there is 5151 edges. This could be useful if you are looking at the accumulation of a given protein (for instance PIN1) at the membrane. The information would be stored in the edges dataframe of the cell graph and I could use it to make a heatmap on the cell contours.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">meshPlotly &lt;-<span class="st"> </span><span class="kw">plotlyMesh</span>(<span class="dt">meshExample =</span> myMesh,</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">           <span class="dt">meshColors =</span> <span class="ot">NULL</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/plotly/topics/layout">layout</a></span>(<span class="dt">scene =</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">           <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">             <span class="dt">aspectmode =</span> <span class="st">"data"</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6">           ))</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="kw">show_cellcontour</span>(<span class="dt">p =</span> meshPlotly, <span class="dt">mesh =</span> myMesh)</a></code></pre></div>
<p><img src="contour.png" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#librairies-needed">Librairies needed</a></li>
      <li><a href="#loading-data">Loading data</a></li>
      <li><a href="#mesh-and-cell-graph-e-g-cells-and-edges-properties">Mesh and cell graph (e.g. cells and edges properties)</a></li>
      <li><a href="#displaying-the-mesh-with-plotly">Displaying the mesh with plotly</a></li>
      <li><a href="#displaying-specific-info-from-cellgraph-on-the-mesh">Displaying specific info from cellGraph on the mesh</a></li>
      <li><a href="#drawing-cell-contours">Drawing cell contours</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Marion Louveaux, Sébastien Rochette.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
